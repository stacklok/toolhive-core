{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://raw.githubusercontent.com/stacklok/toolhive/main/pkg/registry/data/skill.schema.json",
  "title": "ToolHive Skill Schema",
  "description": "Schema for a ToolHive skill entry in the registry",
  "type": "object",
  "required": [
    "namespace",
    "name",
    "description",
    "version"
  ],
  "properties": {
    "namespace": {
      "type": "string",
      "description": "Ownership scope using reverse-DNS pattern (e.g. io.github.stacklok)",
      "minLength": 3,
      "maxLength": 128
    },
    "name": {
      "type": "string",
      "description": "Skill identifier in lowercase alphanumeric with hyphens",
      "minLength": 1,
      "maxLength": 64,
      "pattern": "^[a-z0-9][a-z0-9-]*[a-z0-9]$"
    },
    "description": {
      "type": "string",
      "description": "Human-readable explanation of the skill",
      "minLength": 1,
      "maxLength": 1024
    },
    "version": {
      "type": "string",
      "description": "Version identifier (semantic version or commit hash)",
      "minLength": 1
    },
    "status": {
      "type": "string",
      "description": "Current status of the skill",
      "enum": ["active", "deprecated", "archived"],
      "default": "active"
    },
    "title": {
      "type": "string",
      "description": "Human-readable display title",
      "maxLength": 100
    },
    "license": {
      "type": "string",
      "description": "SPDX license identifier",
      "maxLength": 256
    },
    "compatibility": {
      "type": "string",
      "description": "Environment requirements for the skill",
      "maxLength": 500
    },
    "allowedTools": {
      "type": "array",
      "description": "Pre-approved tools the skill may use (experimental)",
      "items": {
        "type": "string"
      },
      "uniqueItems": true
    },
    "repository": {
      "$ref": "#/$defs/skill_repository"
    },
    "icons": {
      "type": "array",
      "description": "Display icons for the skill",
      "items": {
        "$ref": "#/$defs/skill_icon"
      }
    },
    "packages": {
      "type": "array",
      "description": "Distribution packages (OCI or Git)",
      "items": {
        "$ref": "#/$defs/skill_package"
      }
    },
    "metadata": {
      "type": "object",
      "description": "Official metadata from the SKILL.md file",
      "additionalProperties": true
    },
    "_meta": {
      "type": "object",
      "description": "Extended metadata with reverse-DNS namespaced keys",
      "additionalProperties": true
    }
  },
  "additionalProperties": false,
  "$defs": {
    "skill_package": {
      "type": "object",
      "description": "Distribution package reference (OCI or Git)",
      "required": ["registryType"],
      "properties": {
        "registryType": {
          "type": "string",
          "description": "Package registry type",
          "enum": ["oci", "git"]
        },
        "identifier": {
          "type": "string",
          "description": "OCI image reference"
        },
        "digest": {
          "type": "string",
          "description": "Content digest (sha256 format)"
        },
        "mediaType": {
          "type": "string",
          "description": "Media type of the package"
        },
        "url": {
          "type": "string",
          "description": "Git repository URL",
          "format": "uri"
        },
        "ref": {
          "type": "string",
          "description": "Git branch or tag reference"
        },
        "commit": {
          "type": "string",
          "description": "Git commit SHA"
        },
        "subfolder": {
          "type": "string",
          "description": "Path within the repository"
        }
      },
      "additionalProperties": false
    },
    "skill_icon": {
      "type": "object",
      "description": "Display icon for the skill",
      "required": ["src"],
      "properties": {
        "src": {
          "type": "string",
          "description": "Icon source URL or path"
        },
        "size": {
          "type": "string",
          "description": "Icon dimensions"
        },
        "type": {
          "type": "string",
          "description": "Icon media type"
        },
        "label": {
          "type": "string",
          "description": "Accessibility label for the icon"
        }
      },
      "additionalProperties": false
    },
    "skill_repository": {
      "type": "object",
      "description": "Source repository metadata",
      "properties": {
        "url": {
          "type": "string",
          "description": "Repository URL",
          "format": "uri"
        },
        "type": {
          "type": "string",
          "description": "Repository type (e.g. git)"
        }
      },
      "additionalProperties": false
    }
  }
}
